Hi Raphael,

Heiko and I met with Paolo Pastorelli to discuss his compatibility issue, which turned out to be relatively straightforward.
	•	The VBA code was designed to use an Oracle ODAC driver, which has several limitations:
	•	You can only have either a 32-bit or 64-bit ODAC driver installed, but not both. This means there’s no “seamless” transition between 32-bit and 64-bit.
	•	The ODAC driver must match the exact version of the Oracle client (e.g., ODAC V12 only works with Oracle client V12).
	•	The Company Portal only provides Oracle drivers, not ODAC drivers.
	•	The actuarial databases, to which the system connects, use Oracle version 19. Using an older V12 driver to avoid rewriting the VBA code is a potential security risk. The same could apply to other cases where outdated drivers might pose a security threat.

One solution was to rewrite the code to eliminate the need for the ODAC driver, relying only on the driver provided in the Company Portal (available in both 32-bit and 64-bit versions for Oracle V19). I quickly implemented this, and the VBA code now runs on 64-bit without the ODAC driver.

Heiko then had the brilliant idea of loading the plan data from the actuarial database directly into SAP. This not only solves the Oracle driver issue but also adds significant value, making the process much simpler for Paolo. Now, he can access both actual and planned data in one query, without having to combine them manually.

There may be other legacy 32-bit COM add-ins where the best solution would be SAP as well. Heiko also mentioned that often the 64-bit declarations for Windows API variables in COM add-ins are simply missing, which is easy to fix (e.g., Declare PtrSafe Function MessageBox Lib "user32" Alias "MessageBoxA" (ByVal hwnd As LongPtr, ByVal lpText As String, ByVal lpCaption As String, ByVal uType As Long)).

Would it be possible to provide Paolo and others who might have similar old scripts with a 32-bit Excel version via Citrix or Azure?

This way, they could continue using their legacy scripts while also having access to the 64-bit version for all new work.

My previous company did something similar about 10 years ago. They offered both 32-bit and 64-bit Excel via Citrix a few months before the 64-bit upgrade, so users could test their apps and documents on both versions.

Rather than forcing everyone to continue using 32-bit for legacy apps, most employees could benefit from 64-bit. At the same time, the legacy users would be encouraged to migrate their old apps so everything works on their regular desktops. They would have the chance to migrate and test their apps with both Excel versions.

The added benefit is that it would provide visibility into how many and which users are still using 32-bit Office. Is it just Paolo, or are there five others as well?